var AssetAdapter=function(){function t(){}var e=(__define,t),n=e.prototype;return n.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?i(s):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},i.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},i.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},i.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},i.startCreateScene=function(){this.addChild(ViewControl.getInstance()),ViewControl.getInstance().start()},e}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function t(){}var e=(__define,t),n=e.prototype;return n.getTheme=function(t,e,n,i){function s(t){e.call(i,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var ViewControl=function(t){function e(){t.call(this),this.loginView=new Login,this.registerView=new Register,this.playerStage=new PlayerStage}__extends(e,t);var n=(__define,e),i=n.prototype;return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},i.start=function(){this.addEventListener(GameEvents.GAME_EVENTS,this.onGameEvents,this),this.initData()},i.initData=function(){this.player=this.loginView,this.addChild(this.player)},i.onGameEvents=function(t){switch(t.eventType){case GameEvents.REGISTER_VIEW:this.player=this.registerView;break;case GameEvents.PLAYER_STAGE:this.player=this.playerStage;break;case GameEvents.LOGIN_VIEW:this.player=this.loginView}this.removeChildren(),this.addChild(this.player)},i.dispatch=function(t,e){var n=new GameEvents(GameEvents.GAME_EVENTS);n.eventType=t,n.eventObj=e,this.dispatchEvent(n)},e.instance=null,e}(egret.Sprite);egret.registerClass(ViewControl,"ViewControl");var GlobalData=function(){function t(){}var e=(__define,t);e.prototype;return t.stageW=640,t.stageH=1136,t.userInfo={uid:"",authkey:"",mobile:""},t.urlLogin="http://www.boofa.com.cn/app/index.php?i=4&c=auth&a=login&datatype=json",t.urlRegister="http://www.boofa.com.cn/app/index.php?i=4&datatype=json&c=auth&a=register&datatype=json",t.urlGetCode="http://www.boofa.com.cn/web/index.php?i=4&c=utility&a=verifycode",t.urlPlayerInit="http://www.boofa.com.cn/app/index.php?i=4&c=entry&do=catch&m=hnjiangzhong&datatype=json",t.urlCatch="http://www.boofa.com.cn/app/index.php?i=4&c=entry&op=analyse&do=catch&m=hnjiangzhong&type=0",t}();egret.registerClass(GlobalData,"GlobalData");var GameAudio=function(){function t(t,e){void 0===e&&(e=!0),this.sourceName=null,this.isEffect=null,this.channel=null,this.audioIsPlaying=!1,this.sourceName=t,this.isEffect=e,this.init()}var e=(__define,t),n=e.prototype;return n.init=function(){this.sound=RES.getRes(this.sourceName),this.isEffect?this.sound.type=egret.Sound.EFFECT:this.sound.type=egret.Sound.MUSIC},n.isPlaying=function(){return this.audioIsPlaying},n.play=function(t){void 0===t&&(t=0),this.channel=this.sound.play(0,t),this.channel.addEventListener(egret.Event.COMPLETE,this.onAudioComp,this),this.audioIsPlaying=!0},n.onAudioComp=function(){this.channel&&this.channel.hasEventListener(egret.Event.COMPLETE)&&(this.channel.removeEventListener(egret.Event.COMPLETE,this.onAudioComp,this),this.audioIsPlaying=!1)},n.stop=function(){this.channel.stop(),this.channel.position=0,this.channel=null},n.updateVolume=function(t){var e=0;t>=0&&1>=t?e=t:0>t?e=0:t>1&&(e=1),this.channel.volume=e},t}();egret.registerClass(GameAudio,"GameAudio");var GameEvents=function(t){function e(e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),t.call(this,e,n,i),this.eventType="",this.eventObj=""}__extends(e,t);var n=(__define,e);n.prototype;return e.GAME_EVENTS="GAME_EVENTS",e.REGISTER_VIEW="REGISTER_VIEW",e.LOGIN_VIEW="LOGIN_VIEW",e.FIND_PSD_VIEW="FIND_PSD_VIEW",e.PLAYER_STAGE="PLAYER_STAGE",e}(egret.Event);egret.registerClass(GameEvents,"GameEvents");var HttpEvents=function(t){function e(e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),t.call(this,e,n,i),this.eventType="",this.eventObj=""}__extends(e,t);var n=(__define,e);n.prototype;return e.HTTP_EVENTS="HTTP_EVENTS",e}(egret.Event);egret.registerClass(HttpEvents,"HttpEvents");var Http=function(t){function e(e,n){void 0===n&&(n=egret.HttpMethod.POST),t.call(this),this._url=e,this._type=n,this.init()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.init=function(){this._request=new egret.HttpRequest,this._request.responseType=egret.HttpResponseType.TEXT,this._request.open(this._url,this._type),this._request.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this._request.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this._request.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this),this._request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)},i.send=function(t){void 0===t&&(t=null),this._request.send(t)},i.onPostComplete=function(t){var e=t.currentTarget,n=e.response;console.log("receive",n);var i=new HttpEvents(HttpEvents.HTTP_EVENTS);i.eventObj=n,i.eventType=HttpEvents.HTTP_EVENTS,this.dispatchEvent(i)},i.onPostIOError=function(t){console.log("post error : "+t);var e=new HttpEvents(HttpEvents.HTTP_EVENTS);e.eventObj=JSON.stringify({error:"error"}),e.eventType=HttpEvents.HTTP_EVENTS,this.dispatchEvent(e)},i.onPostProgress=function(t){console.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%");var e=new HttpEvents(HttpEvents.HTTP_EVENTS);e.eventObj=JSON.stringify({error:"error"}),e.eventType=HttpEvents.HTTP_EVENTS,this.dispatchEvent(e)},e}(egret.Sprite);egret.registerClass(Http,"Http");var Utils;!function(t){function e(t){var e=/^(13[0-9]|14[57]|15[012356789]|17[0678]|18[0-9])\d{8}$/;return e.test(""+t)?!0:!1}function n(t){var e=t.replace(/^\s+|\s+$/g,"");return e.length<6||e.length>20?!1:!0}function i(t){var e=/^[0-9]*[1-9][0-9]*$/;return e.test(t)?!0:!1}function s(t){}t.isPhoneNumber=e,t.isPsd=n,t.isInt=i,t.getCookies=s}(Utils||(Utils={}));var ItemRenderer=function(t){function e(){t.call(this),this.skinName="MyItemRendererSkin"}__extends(e,t);var n=(__define,e),i=n.prototype;return i.dataChanged=function(){this.periodId.text=""+this.data.order,this.sumId.text=""+this.data.he,this.itemCenterFour.text=""+this.data.num7,this.itemCenterThree.text=""+this.data.num6,this.itemCenterTwo.text=""+this.data.num5,this.itemCenterOne.text=""+this.data.num4,this.itemRightThree.text=""+this.data.num3,this.itemRightTwo.text=""+this.data.num2,this.itemRightOne.text=""+this.data.num1},e}(eui.ItemRenderer);egret.registerClass(ItemRenderer,"ItemRenderer");var Login=function(t){function e(){t.call(this),this.isGetCoding=!1,this.isPsdLogin=!0,this.isLogining=!1,this.skinName="LoginSkin",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onAddedToStage=function(){console.log("added")},i.onRemovedFromStage=function(){},i.childrenCreated=function(){t.prototype.childrenCreated.call(this),console.log("created"),this.loginLoginLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin,this),this.loginLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin,this),this.loginNoticeCont.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLoginWay,this),this.loginRegiterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRegister,this),this.loginFogetPsdBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFindPsd,this),this.loginPsdInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this),this.loginPhoneInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this)},i.onFocusIn=function(t){this.loginErrorNotice.text=""},i.onLogin=function(t){if(!Utils.isPhoneNumber(Number(this.loginPhoneInput.text))||!Utils.isPsd(this.loginPsdInput.text)||this.isLogining)return this.loginErrorNotice.text="手机号或者密码错误",!1;var e="basic";this.isPsdLogin,e="basic";var n={mode:"basic",password:""+this.loginPsdInput.text,username:""+this.loginPhoneInput.text},i=new Http(GlobalData.urlLogin);i.send(JSON.stringify(n)),i.addEventListener(HttpEvents.HTTP_EVENTS,this.onComplete,this),this.loginErrorNotice.text="登录中...",this.isLogining=!0},i.onComplete=function(t){this.loginErrorNotice.text="",this.isLogining=!1,console.log("请求成功");var e=JSON.parse(t.eventObj),n=e.result,i=e.status;0==i?(GlobalData.userInfo=JSON.parse(n),ViewControl.getInstance().dispatch(GameEvents.PLAYER_STAGE,this)):this.loginErrorNotice.text=n},i.onChangeLoginWay=function(t){this.isPsdLogin?(this.isPsdLogin=!1,this.loginNoticeCont.text="用密码登录",this.loginGetCode.visible=!0,this.loginPsdInput.prompt="请输入验证码"):(this.isPsdLogin=!0,this.loginNoticeCont.text="用验证码登录",this.loginGetCode.visible=!1,this.loginPsdInput.prompt="请输入密码")},i.onRegister=function(t){ViewControl.getInstance().dispatch(GameEvents.REGISTER_VIEW,this)},i.onFindPsd=function(t){},e}(eui.Component);egret.registerClass(Login,"Login");var PlayerStage=function(t){function e(){t.call(this),this.catchStartTime=0,this.catchEndTime=0,this.distanceTime=2e3,this.isCatching=!1,this.skinName="PlayerStageSkin",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.childrenCreated=function(){t.prototype.childrenCreated.call(this),console.log("created");var e=[{order:"12",he:"12",num1:"1",num2:"2",num3:"3",num4:"4",num5:"5",num6:"6",num7:"7"}];this.playerDataList.dataProvider=new eui.ArrayCollection(e),this.playerDataList.itemRenderer=ItemRenderer,this.playerDataScroller.viewport=this.playerDataList,this.playerDataList.useVirtualLayout=!0},i.onAddedToStage=function(){console.log("added"),this.init()},i.init=function(){this.playerCatchBtnMask.touchEnabled=!1,this.onRankList(null),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.playerCatchBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCatchBegin,this),this.playerCatchBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onCatchEnd,this),this.playerCatchBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCatchEnd,this),this.playerRankList.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRankList,this),this.playerCatchLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCatchLabel,this),this.playerMine.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMine,this),this.requestInitInfo()},i.onRemovedFromStage=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.playerCatchBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onCatchBegin,this),this.playerCatchBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onCatchEnd,this),this.playerCatchBtn.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onCatchEnd,this),this.playerRankList.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRankList,this),this.playerCatchLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCatchLabel,this),this.playerMine.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMine,this)},i.onCatchBegin=function(t){this.catchStartTime=egret.getTimer(),this.isCatching=!0,this.playerCatchBtnMask.visible=!0},i.onCatchEnd=function(t){this.catchEndTime=egret.getTimer(),this.isCatching=!1,this.playerCatchBtnMask.mask=null,this.playerCatchBtnMask.visible=!1;var e=this.catchEndTime-this.catchStartTime;e>this.distanceTime},i.requestInitInfo=function(){var t=GlobalData.userInfo,e=t.uid,n=t.authkey,i=Date.now().toString(),s=(new md5).hex_md5(""+e+i+n);egret.localStorage.getItem("uid")&&egret.localStorage.setItem("uid",e),egret.localStorage.getItem("autht")&&egret.localStorage.setItem("autht",i.toString()),egret.localStorage.getItem("auths")&&egret.localStorage.setItem("auths",s);var r={uid:""+e,autht:""+i,auths:""+s},o="&uid="+e+"&autht="+i+"&auths="+s,a=new Http(GlobalData.urlPlayerInit+o,egret.HttpMethod.GET);console.log(JSON.stringify(r)),a.addEventListener(HttpEvents.HTTP_EVENTS,this.onInitInfoComp,this),a.send(JSON.stringify(""))},i.onInitInfoComp=function(t){if(console.log(t.eventObj),t.eventObj.indexOf("error")>-1)return!1;var e=JSON.parse(t.eventObj),n=e.records;e.userInfo,e.nums;this.playerDataList.dataProvider=new eui.ArrayCollection(n)},i.onEnterFrame=function(t){var e=egret.getTimer()-this.catchStartTime;if(!(e>this.distanceTime)&&this.isCatching&&this.playerCatchBtn.visible){var n=this.playerCatchBtn.x,i=this.playerCatchBtn.y,s=this.playerCatchBtn.height,r=this.playerCatchBtn.width,o=Math.ceil(e*r/2e3);this.playerCatchBtnMask.mask=new egret.Rectangle(0,0,o,s),console.log("x",n,"y",i)}},i.onRankList=function(t){this.normalBottomGroup(),this.playerRankList.source="rankListActive_png"},i.onCatchLabel=function(t){this.normalBottomGroup(),this.playerCatchLabel.source="catchLabelActive_png"},i.onMine=function(t){this.normalBottomGroup(),this.playerMine.source="mineActive_png"},i.normalBottomGroup=function(){this.playerRankList.source="rankListNormal_png",this.playerMine.source="mineNormal_png",this.playerCatchLabel.source="catchLabelNormal_png"},e}(eui.Component);egret.registerClass(PlayerStage,"PlayerStage");var Register=function(t){function e(){t.call(this),this.isGetingCode=!1,this.disNum=60,this.DIS_TIME=1e3,this.startTime=0,this.skinName="RegisterSkin",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i.onAddedToStage=function(t){this.init()},i.onRemovedFromStage=function(t){this.isGetingCode=!1,this.disNum=60},i.init=function(){this.registerRegisBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRegister,this),this.registerGetCodeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetCode,this),this.registerCodeInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this),this.registerPhoneInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this),this.registerPsdInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this),this.registerRepeatPwdInput.addEventListener(egret.Event.FOCUS_IN,this.onFocusIn,this),this.registerPsdInput.addEventListener(egret.Event.FOCUS_OUT,this.onPsdFocusOut,this),this.registerRepeatPwdInput.addEventListener(egret.Event.FOCUS_OUT,this.onPsdFocusOut,this),this.returnLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturnLoginView,this)},i.onReturnLoginView=function(t){ViewControl.getInstance().dispatch(GameEvents.LOGIN_VIEW,this)},i.onFocusIn=function(t){this.registerErrorNotice.text=""},i.onPsdFocusOut=function(t){this.registerErrorNotice.text="两次密码输入不一致"},i.onRegister=function(t){var e={code:this.registerCodeInput.text,password:"123787584",repassword:"123787584",username:"13163262533"},n=({code:this.registerCodeInput.text,password:this.registerPsdInput.text,repassword:this.registerRepeatPwdInput.text,username:this.registerPhoneInput.text},new Http(GlobalData.urlRegister));n.send(JSON.stringify(e)),n.addEventListener(HttpEvents.HTTP_EVENTS,this.onRegisterComplete,this)},i.onRegisterComplete=function(t){console.log("注册请求成功");var e=JSON.parse(t.eventObj),n=e.result,i=e.status;0==i?ViewControl.getInstance().dispatch(GameEvents.PLAYER_STAGE,this):this.registerErrorNotice.text=n},i.onGetCode=function(t){if(this.isGetingCode)return!1;if(this.isGetingCode=!0,!Utils.isPhoneNumber(Number(this.registerPhoneInput.text)))return this.registerErrorNotice.text="手机号格式错误",!1;this.addEventListener(egret.Event.ENTER_FRAME,this.onPerTime,this),this.startTime=egret.getTimer(),this.disNum=60,this.registerGetCodeBtn.text=""+this.disNum;var e=this.registerPhoneInput.text,n=new Http(GlobalData.urlGetCode+"&receiver="+e);n.send(),n.addEventListener(HttpEvents.HTTP_EVENTS,this.onGetCodeComplete,this)},i.onGetCodeComplete=function(t){},i.onPerTime=function(t){var e=egret.getTimer();e-this.startTime>this.DIS_TIME&&(this.disNum-=1,this.registerGetCodeBtn.text=""+this.disNum,this.startTime=e),this.disNum<=0&&(this.isGetingCode=!1,this.registerGetCodeBtn.text="获取验证码",this.removeEventListener(egret.Event.ENTER_FRAME,this.onPerTime,this))},e}(eui.Component);egret.registerClass(Register,"Register");